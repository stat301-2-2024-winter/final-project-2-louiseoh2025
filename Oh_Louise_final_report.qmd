---
title: "my own title"
subtitle: |
  | Final Project 
  | Data Science 2 with R (STAT 301-2)
author: "Louise Oh"
date: today

format:
  html:
    toc: true
    embed-resources: true
    
execute:
  echo: false
  warning: false
  message: false

from: markdown+emoji 
reference-location: margin
citation-location: margin
---

::: {.callout-tip icon=false}
## Github Repo Link

[https://github.com/stat301-2-2024-winter/final-project-2-louiseoh2025.git](https://github.com/stat301-2-2024-winter/final-project-2-louiseoh2025.git)

:::

```{r}
#| label: load-everything
#| echo: false
# load packages
library(tidyverse)
library(tidymodels)
library(here)
library(knitr)
library(skimr)
# load fits
load(here("results/fit_lm.rda"))
load(here("results/tuned_lasso.rda"))
load(here("results/tuned_ridge.rda"))
load(here("results/tuned_knn.rda"))
load(here("results/tuned_bt.rda"))
load(here("results/tuned_rf.rda"))
```


## Introduction

The COVID-19 pandemic was a substantial stressor, especially for pregnant individuals. The Mental Health In Pregnancy During COVID-19 Dataset^[Mental Health In Pregnancy During COVID-19 --- [https://www.kaggle.com/datasets/yeganehbavafa/mental-health-in-the-pregnancy-during-the-covid-19](https://www.kaggle.com/datasets/yeganehbavafa/mental-health-in-the-pregnancy-during-the-covid-19)] is aimed to understand the impact of COVID-19-related stresses on pregnant individuals and their infants and collected survey-based data across Canada as part of the Pregnancy during the COVID-19 Pandemic (PdP) project. This survey-based data allows for insights that can inform targeted interventions and support strategies to address the impact of COVID-19-related stresses on maternal and infant health.

::: {.callout-note icon="false"}
## Prediction Research Objective 

The goal is regression, specifically what the weight of the baby will be at birth based on the biological and psychological factors of mother and baby during a pandemic.

:::

Developing a regression model to predict the weight of a child at birth based on the biological and psychological factors of the mother and baby during a pandemic is a crucial endeavor with profound implications for maternal and infant health. Accurate estimation of birth weight is paramount in identifying potential risks and tailoring appropriate prenatal care interventions. In the context of a pandemic, where stressors and uncertainties may exacerbate health challenges, a predictive model for birth weight contributes to the early identification of high-risk pregnancies. This research not only addresses a fundamental aspect of perinatal care but also aligns with the broader goal of enhancing maternal and infant outcomes in the face of unique pandemic-related stressors. By providing healthcare professionals with a reliable tool for predicting birth weight, this research strives to optimize prenatal care strategies, ultimately promoting the health and well-being of both mothers and infants during challenging times.


## Data Overview

```{r}
#| label: tbl-data-codebook
#| tbl-cap: "Data Codebook"
#| echo: false

# load data codebook
load(here("data/pregnancy_codebook.rda"))
# view codebook
pregnancy_codebook |> 
  kable()
```

@tbl-data-codebook 

```{r}
#| label: tbl-data-overview
#| tbl-cap: "Skim Dataset"
#| echo: false

# load data 
load(here("data/pregnancy_clean.rda"))
# skim data
skim_without_charts(pregnancy)
```

**write about the dataset, variables, and missingness**

@tbl-data-overview

**skewedness or class imbalance?**

```{r}
#| label: fig-target-var
#| fig-cap: "Distribution of Target Variable"
#| echo: false

# load splitted data
load(here("results/pregnancy_split.rda"))
# target variable distribution
ggplot(pregnancy_train, aes(x = birth_weight)) +
  geom_histogram(fill = "skyblue", color = "black", bins = 35) +
  theme_minimal() +
  labs(title = "Distribution of Child's Weight at Birth",
       x = "Birth Weight (g)",
       y = NULL)
```

The target variable is `birth_weight`, a numerical variable in the form of double. @fig-target-var below shows a unimodal distribution that is slightly skewed toward the left, but still nearly symmetric. The distribution looks nearly normal with outliers on both ends, but slightly more on the lower end. The original data has a distribution closer to a normal distribution compared to when it is transformed. Thus, the original data without transformation will be used for fitting the models.


## Methods

#### Data Spliting
The cleaned pregnancy data was split into training (80%) and testing (20%) datasets. The split was stratified by the target variable, `birth_weight`. 

#### Resampling
Repeated V-fold cross-validation with 5 folds and 3 repeats are performed on the training data. This technique randomly and repeatedly splits the data into 5 subsets of approximately equal size for training and validation. With this particular setup, each model will be trained and evaluated 15 times. This is better than simply fitting and testing the models because it prevents overfitting and improves parameter and model accuracy by taking the uncertainty into account.


#### Recipe
Kitchen sink recipe
Customized recipe

#### Model Type and Parameter Tuning
Linear regression model - none
Lasso regression model - penalty
Ridge regression model - penalty
K Nearest Neighbor model - neighbors
Boosted Tree model - mtry, min_n
Random Forest model - mtry, min_n, learn_rate

#### Metric
This prediction research objective is a regression problem. Therefore, the RMSE metric mean and standard error is used to compare and ultimately select the final model. 


## Model Building & Selection Results

**Should reiterate the metric that will be used to compare models and determine which will be the final/winning model. Include a table of the best performing model results. Review and analysis of tuning parameters should happen here. Should further tuning be explored? Or how should tuning be adjusted when fitting data like this in the future. This would be a good section to describe what the best parameters were for each model type. Could include a discussion comparing any systematic differences in performance between model types or recipes. If variations in recipes were used to explore predictive importance of certain variables, then it should be discussed here. The section will likely end with the selection of the final/winning model (provide your reasoning). Was it surprising or not surprising that this particular model won? Explain.**

## Final Model Analysis

**This is where you fit your final/winning model to the testing data. Assess the final model’s performance with at least the metric used to determine the winning model, but it is also advisable to use other performance metrics (especially ones that might be easier to communicate/understand). Should include an exploration of predictions vs the true values (graph) or a confusion matrix (table). Remember to consider the scale of your outcome variable at this time — did you transform the target variable? If a transformation was used, then you should consider conducting analyses on both the original and transformed scale of the target variable. Is the model any good? It might be the best of the models you tried, but does the effort of building a predictive model really pay off — is it that much better than a baseline/null model? Were there any features of the model you selected that make it the best (e.g. fits nonlinearity well)?**


## Conclusion

**State any conclusions or discoveries/insights. Future work, new research questions, and next steps.**


## References

**Any references used should be sited here. This includes but is not limited to where you got your data. There is no “formal” reference guideline but we recommend APA format. Example: Lastname, F. M. (Year, Month Date). Title of page. Site name. URL**


## Appendix: EDA


